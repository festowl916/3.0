<script>
const SCRIPT_URL = "PASTE_LINK_DEPLOY_BARU_KAU";

document.getElementById("daftarForm").addEventListener("submit", function(e){
  e.preventDefault();

  const form = e.target;
  const file = form.resit.files[0];
  if (!file) { alert("Sila upload resit"); return; }

  const reader = new FileReader();
  reader.onload = function () {

    const data = {
      jenis_pendaftaran: form.jenis_pendaftaran.value,
      nama_penuh: form.nama_penuh.value,
      kelab: form.kelab.value,
      kategori: Array.from(
        document.querySelectorAll("input[name='kategori[]']:checked")
      ).map(i=>i.value).join(", "),
      negeri: form.negeri.value,
      saiz_baju: form.saiz_baju.value,
      alamat_penghantaran: form.alamat_penghantaran.value,
      ic: form.ic.value,
      telefon: form.telefon.value,
      fileName: file.name,
      fileType: file.type,
      fileData: reader.result.split(",")[1]
    };

    fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify(data),
      headers: { "Content-Type": "application/json" }
    })
    .then(r => r.text())
    .then(() => {
      alert("Pendaftaran berjaya");
      form.reset();
    })
    .catch(() => alert("Gagal hantar"));
  };

  reader.readAsDataURL(file);
});
</script>
